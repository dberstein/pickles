$(document).ready(function(){jQuery().validate&&$("form").validate();$("form.ajax input[type=submit], form.ajax .submit").live("click",function(){var a=$(this).parents("form").get();$(".ajax-form-error, .ajax-form-message, label.error",a).fadeOut("normal",function(){$(this).remove()});if(typeof $(a).valid=="undefined"||$(a).valid()==true){$("button, input, textarea",a).attr("readonly","readonly");document.body.style.cursor="wait";if(typeof CKEDITOR!="undefined")if(typeof CKEDITOR.instances!="undefined")for(var d in CKEDITOR.instances){var b=
CKEDITOR.instances[d].getData();b!=""&&$("#"+d).val(b)}d=$(a).attr("method")==""?"GET":$(a).attr("method");b=$(a).attr("action");if(b==""){injectMessage(a,"Form element lacks action attribute","error");$("button, input, textarea",a).attr("readonly","");document.body.style.cursor="default"}else $.ajax({type:d,url:b,data:$(a).serialize(),dataType:"json",success:function(c){if(c.status!="success"&&typeof c.message!="undefined")injectMessage(a,c.message,"error");else if(c.status=="success"){$("input[type=text]",
a).val("");$("select",a).val("");$("textarea",a).val("");typeof c.message!="undefined"&&injectMessage(a,c.message,"message");if(typeof c.url!="undefined")parent.location.href=c.url}else injectMessage(a,c,"error");typeof c.callback!="undefined"&&window[c.callback](c);$("button, input, textarea",a).attr("readonly","");document.body.style.cursor="default"},error:function(c,e,f){injectMessage(a,f,"error");$("button, input, textarea",a).attr("readonly","");document.body.style.cursor="default"}})}else return false});
$("form.ajax").submit(function(){return false});$("table tr:even td").addClass("even");$("table tr:odd td").addClass("odd")});
function injectMessage(a,d,b,c){if(typeof b=="undefined")b="error";switch(b){case "error":var e="#800";break;case "message":e="#080";break;default:e="#000"}b="ajax-form-"+b;e="display:none;color:"+e;$("."+b,a).remove();$(a).prepend('<div class="'+b+'" style="'+e+'" generated="true">'+d+"</div>");$("."+b,a).fadeIn();typeof c!="undefined"&&$("."+b,a).delay(c).fadeOut();return $("."+b,a)}function autoTab(a){$(a).val().length>=$(a).attr("maxlength")&&$(a).next().focus()}
function disableEnterKey(a){return(window.event?window.event.keyCode:a.which)!=13}function truncate(a,d,b){if(a.length>d)a=b==true?'<span title="'+a+'" style="cursor:help">'+a.substring(0,d)+"...</span>":a.substring(0,d)+"...";return a};
